# Телеграм-бот «Этап-Тест 7D»

Этот бот представляет собой опросник для определения стадии духовного развития по 7-уровневой модели, вдохновлённой учением Шри Ауробиндо. Он проводит пользователя через серию вопросов и в конце показывает результат.

## Возможности

- **Три блока вопросов с выбором ответа (A, B, C):** 119 закрытых вопросов для оценки убеждений, состояний и искренности.
- **Автоматический расчёт этапа:** Бот анализирует ответы и определяет текущий этап (от 0 до 7).
- **Проверка на искажение:** Блок C помогает оценить, насколько пользователь склонен давать «социально желательные» ответы.
- **Блок D (интервью):** 10 открытых вопросов, ответы на которые отправляются администратору для более глубокого анализа.
- **Опциональная PDF-сводка:** В будущем планируется генерация PDF-отчёта с ответами на вопросы блока D для пользователя (требует `reportlab`).

---

## Установка и запуск

### 1. Предварительные требования

- Установленный **Python 3.8** или новее.

### 2. Настройка окружения

1.  **Склонируйте или скачайте репозиторий.**
    ```bash
    git clone <адрес_репозитория>
    cd <папка_с_ботом>
    ```
    Или просто скачайте файлы `etap_test_bot.py`, `questions_b.json` и `requirements.txt` в одну папку.

2.  **Создайте и активируйте виртуальное окружение.** Это рекомендуется, чтобы не засорять системные библиотеки.
    ```bash
    # Для Windows
    python -m venv venv
    .\venv\Scripts\activate

    # Для macOS / Linux
    python3 -m venv venv
    source venv/bin/activate
    ```

3.  **Установите зависимости.** Все необходимые пакеты перечислены в `requirements.txt`.
    ```bash
    pip install -r requirements.txt
    ```

### 3. Конфигурация

Боту требуются два параметра для работы, которые передаются через переменные окружения.

1.  **`BOT_TOKEN`** — токен вашего Telegram-бота.
    - Откройте Telegram и найдите бота `@BotFather`.
    - Создайте нового бота командой `/newbot`.
    - Следуйте инструкциям и скопируйте полученный токен API.

2.  **`CHAT_ID_ADMIN`** — ваш ID в Telegram для получения ответов из блока D.
    - Найдите бота `@userinfobot`.
    - Отправьте ему команду `/start`.
    - Он пришлёт ваш ID. Скопируйте его.
    - Этот параметр не является обязательным. Если его не указать, бот будет работать, но ответы на блок D не будут никому отправляться.

#### Как задать переменные окружения

Вы можете создать файл `.env` в корневой папке проекта. Бот автоматически его прочитает.

**Пример файла `.env`:**
```
BOT_TOKEN="1234567890:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
CHAT_ID_ADMIN="987654321"
```

Либо вы можете задать их напрямую в терминале перед запуском (значения будут сброшены после закрытия терминала).

```bash
# Для Windows (PowerShell)
$env:BOT_TOKEN="ВАШ_ТОКЕН"
$env:CHAT_ID_ADMIN="ВАШ_ID"

# Для macOS / Linux
export BOT_TOKEN="ВАШ_ТОКЕН"
export CHAT_ID_ADMIN="ВАШ_ID"
```

### 4. Запуск бота

После установки зависимостей и настройки конфигурации запустите главный скрипт:

```bash
python etap_test_bot.py
```

Если всё настроено правильно, в консоли вы увидите сообщение `Bot started`. Теперь вы можете найти своего бота в Telegram и начать диалог командой `/start`. 